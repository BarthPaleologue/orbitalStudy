(()=>{"use strict";var t=function(){function t(t,n){this.x=t,this.y=n}return t.prototype.add=function(n){return new t(this.x+n.x,this.y+n.y)},t.prototype.addInPlace=function(t){this.x+=t.x,this.y+=t.y},t.prototype.scaleInPlace=function(t){this.x*=t,this.y*=t},t.prototype.subtract=function(n){return new t(this.x-n.x,this.y-n.y)},t.prototype.subtractInPlace=function(t){this.x-=t.x,this.y-=t.y},t.prototype.rotateInPlaceBy=function(t){var n=this.x*Math.cos(t)-this.y*Math.sin(t),i=this.x*Math.sin(t)+this.y*Math.cos(t);this.x=n,this.y=i},t.DistanceSquared=function(t,n){return Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2)},t.Distance=function(n,i){return Math.sqrt(t.DistanceSquared(n,i))},t.Direction=function(t,n){var i=n.subtract(t);return i.normalizeInPlace(),i},t.prototype.normalizeInPlace=function(){var t=Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2));0!=t&&(this.x/=t,this.y/=t)},t.prototype.clone=function(){return new t(this.x,this.y)},t}(),n=window.innerWidth,i=window.innerHeight,o=new t(n/2,i/2);function r(t,n){return Math.floor(Math.random()*(n-t)+t)}function e(t,n){return t+n*Math.sqrt(-2*Math.log(Math.random()))*Math.cos(2*Math.PI*Math.random())}function a(t,n,i,o){return Math.min(Math.max(e(t,n),i),o)}function s(t,n,i){return n-t+i*Math.sin(t)}function h(t,n,i,o){var r=(n+t)/2;return 2*Math.PI*r*Math.sqrt(r/(5e-4*(i+o)))}var c=function(){function e(n,i,o,a,s,h){this.positionHistory=[],this.id=e.bodyCounter,e.bodyCounter++,this.orbitalPeriod=n,this.periapsis=i,this.apoapsis=o,this.position=new t(0,0),this.parent=a,this.pointSize=s||10,this.color=h||"rgb(".concat(r(50,255),", ").concat(r(50,255),", ").concat(r(50,255),")"),this.orbitAngle=Math.random()*Math.PI*2}return e.prototype.update=function(n){var i=new t(0,0);null!=this.parent&&(i=this.parent.position),this.position=function(n,i,o,r){var e=(i+o)/2,a=e-i,h=a/e,c=Math.sqrt(Math.pow(e,2)-Math.pow(a,2)),u=n.x-a,l=n.y,y=function(t,n){for(var i=1e-4,o=t,r=0;r<100;r++){var e=s(o,t,n);if(Math.abs(e)<1e-6)break;o-=e/((s(o+i,t,n)-e)/i)}return o}(2*Math.PI*r,h),p=Math.cos(y)*e+u,f=Math.sin(y)*c+l;return new t(p,f)}(i,this.periapsis,this.apoapsis,n);var o=this.position.subtract(i);o.rotateInPlaceBy(this.orbitAngle),this.position=o.add(i),this.positionHistory.push(this.position.clone())},e.prototype.draw=function(t,r,e){if(function(t){return t.x>=0&&t.y>=0&&t.x<=n&&t.y<=i}(this.position.subtract(e).add(o))){if(t.fillStyle=this.color,r.fillStyle=this.color,this.positionHistory.length>0){var a=this.positionHistory[this.positionHistory.length-1];r.beginPath(),r.arc(a.x-e.x+o.x,a.y-e.y+o.y,Math.min(this.pointSize/3,3),0,6.28),r.closePath()}t.beginPath(),t.arc(this.position.x-e.x+o.x,this.position.y-e.y+o.y,this.pointSize,0,6.28),t.closePath()}},e.bodyCounter=0,e}(),u=function(t){var n="function"==typeof Symbol&&Symbol.iterator,i=n&&t[n],o=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")},l=document.getElementById("renderCanvas");l.width=n,l.height=i;var y=document.getElementById("traceCanvas");y.width=n,y.height=i;var p=l.getContext("2d"),f=y.getContext("2d"),d=[],x=new c(10,10,20,null,20,"yellow");d.push(x);for(var v=1;v<r(3,7);v++){var w=v*a(90,10,70,110),M=w*a(.9,.1,.5,1),b=w*a(1.1,.1,1,1.7),m=1e9*e(1,.2),g=new c(h(M,b,m,1e10),M,b,x,10);d.push(g);for(var P=1;P<r(1,4);P++){var I=P*a(15,1,10,20),S=I*a(.9,.05,.5,1),q=I*a(1.1,.05,1,1.5),C=new c(h(S,q,1e5,m),S,q,g,5);d.push(C)}}console.table(d);var H=0;requestAnimationFrame((function n(){var i,o,r=Date.now()/1e3;try{for(var e=u(d),a=e.next();!a.done;a=e.next()){var s=a.value;s.update(r/s.orbitalPeriod)}}catch(t){i={error:t}}finally{try{a&&!a.done&&(o=e.return)&&o.call(e)}finally{if(i)throw i.error}}!function(){var n,i;p.clearRect(0,0,p.canvas.width,p.canvas.height);try{for(var o=u(d),r=o.next();!r.done;r=o.next())r.value.draw(p,f,-1==H?new t(0,0):d[H].position),p.fill(),f.fill()}catch(t){n={error:t}}finally{try{r&&!r.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}}(),requestAnimationFrame(n)})),document.addEventListener("keydown",(function(t){isNaN(Number(t.key))||(H=Number(t.key),f.clearRect(0,0,n,i))}))})();