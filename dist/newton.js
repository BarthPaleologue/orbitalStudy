(()=>{"use strict";var t=function(){function t(t,n){this.x=t,this.y=n}return t.prototype.add=function(n){return new t(this.x+n.x,this.y+n.y)},t.prototype.addInPlace=function(t){this.x+=t.x,this.y+=t.y},t.prototype.scaleInPlace=function(t){this.x*=t,this.y*=t},t.prototype.subtract=function(n){return new t(this.x-n.x,this.y-n.y)},t.prototype.subtractInPlace=function(t){this.x-=t.x,this.y-=t.y},t.prototype.rotateInPlaceBy=function(t){var n=this.x*Math.cos(t)-this.y*Math.sin(t),e=this.x*Math.sin(t)+this.y*Math.cos(t);this.x=n,this.y=e},t.DistanceSquared=function(t,n){return Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2)},t.Distance=function(n,e){return Math.sqrt(t.DistanceSquared(n,e))},t.Direction=function(t,n){var e=n.subtract(t);return e.normalizeInPlace(),e},t.prototype.normalizeInPlace=function(){var t=Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2));0!=t&&(this.x/=t,this.y/=t)},t.prototype.clone=function(){return new t(this.x,this.y)},t}(),n=5e-4,e=window.innerWidth,i=window.innerHeight,r=new t(e/2,i/2);function o(t,n){return Math.floor(Math.random()*(n-t)+t)}function a(t,n){return t+n*Math.sqrt(-2*Math.log(Math.random()))*Math.cos(2*Math.PI*Math.random())}function s(t,e){return Math.sqrt(n*t/e)}var c=function(){function t(n,e,i,r,a,s){this.positionHistory=[],this.id=t.bodyCounter,t.bodyCounter++,this.mass=n,this.position=e,this.velocity=i;var c=Math.random()*Math.PI*2;this.position.rotateInPlaceBy(c),this.velocity.rotateInPlaceBy(c),null!=r&&(this.position.addInPlace(r.position),this.velocity.addInPlace(r.velocity)),this.parent=r,this.pointSize=a||10,this.color=s||"rgb(".concat(o(50,255),", ").concat(o(50,255),", ").concat(o(50,255),")")}return t.prototype.update=function(t){this.velocity.addInPlace(t),this.positionHistory.push(this.position.clone()),this.position.addInPlace(this.velocity)},t.prototype.draw=function(t,n,o){if(function(t){return t.x>=0&&t.y>=0&&t.x<=e&&t.y<=i}(this.position.subtract(o).add(r))){if(t.fillStyle=this.color,n.fillStyle=this.color,this.positionHistory.length>0){var a=this.positionHistory[this.positionHistory.length-1];n.beginPath(),n.arc(a.x-o.x+r.x,a.y-o.y+r.y,Math.min(this.pointSize/3,3),0,6.28),n.closePath()}t.beginPath(),t.arc(this.position.x-o.x+r.x,this.position.y-o.y+r.y,this.pointSize,0,6.28),t.closePath()}},t.bodyCounter=0,t}(),h=function(t){var n="function"==typeof Symbol&&Symbol.iterator,e=n&&t[n],i=0;if(e)return e.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")},l=function(t,n){var e="function"==typeof Symbol&&t[Symbol.iterator];if(!e)return t;var i,r,o=e.call(t),a=[];try{for(;(void 0===n||n-- >0)&&!(i=o.next()).done;)a.push(i.value)}catch(t){r={error:t}}finally{try{i&&!i.done&&(e=o.return)&&e.call(o)}finally{if(r)throw r.error}}return a},y=document.getElementById("renderCanvas");y.width=e,y.height=i;var u=document.getElementById("traceCanvas");u.width=e,u.height=i;var d=y.getContext("2d"),f=u.getContext("2d"),p=[],v=2e6,w=new c(v,new t(0,0),new t(0,0),null,20,"yellow");p.push(w);for(var x=1;x<o(3,5);x++){var m=100*x*a(1,.1),M=s(v,m)*a(1,.1),b=2e4*a(1,.2),P=new c(b,new t(0,m),new t(M,0),w,7);p.push(P);for(var I=0;I<1;I++){var g=10*a(1,.1),S=s(b,g),q=new t(0,g),C=new t(S,0);p.push(new c(.001,q,C,P,4))}}var D=0;requestAnimationFrame((function e(){var i,r,o,a,s,c,y=[];try{for(var u=h(p),v=u.next();!v.done;v=u.next()){var w=v.value,x=new t(0,0);try{for(var m=(o=void 0,h(p)),M=m.next();!M.done;M=m.next()){var b=M.value;if(b.id!=w.id){var P=t.DistanceSquared(w.position,b.position),I=t.Direction(w.position,b.position);I.scaleInPlace(n*b.mass/P),x.addInPlace(I)}}}catch(t){o={error:t}}finally{try{M&&!M.done&&(a=m.return)&&a.call(m)}finally{if(o)throw o.error}}y.push(x)}}catch(t){i={error:t}}finally{try{v&&!v.done&&(r=u.return)&&r.call(u)}finally{if(i)throw i.error}}try{for(var g=h(p.entries()),S=g.next();!S.done;S=g.next()){var q=l(S.value,2),C=q[0];(w=q[1]).update(y[C])}}catch(t){s={error:t}}finally{try{S&&!S.done&&(c=g.return)&&c.call(g)}finally{if(s)throw s.error}}!function(){var n,e;d.clearRect(0,0,d.canvas.width,d.canvas.height);try{for(var i=h(p),r=i.next();!r.done;r=i.next())r.value.draw(d,f,-1==D?new t(0,0):p[D].position),d.fill(),f.fill()}catch(t){n={error:t}}finally{try{r&&!r.done&&(e=i.return)&&e.call(i)}finally{if(n)throw n.error}}}(),requestAnimationFrame(e)})),document.addEventListener("keydown",(function(t){switch(t.key){case"0":D=0,f.clearRect(0,0,e,i);break;case"1":D=1,f.clearRect(0,0,e,i);break;case"2":D=2,f.clearRect(0,0,e,i);break;case".":D=-1,f.clearRect(0,0,e,i)}}))})();